<div style='height: 200px;'></div>

{{#if errors}}
  <div class='col-12 w-100 d-flex justify-content-center mt-1 mb-1'>
    <p class='alert alert-danger w-50 text-center align-self-center'>{{errors}}</p>
  </div>
{{/if}}

{{#if errorFilePath}}
  <div class='col-12 w-100 d-flex justify-content-center mt-1 mb-1 flex-column'>
    <p class='alert alert-danger w-50 text-center align-self-center'>برخی از ردیفهای فایل خطا داشتند؛ برای مشاهد خطاها لطفا
      <a style='font-size: 17px;font-style: italic;color:#01019e' href='/importFiles/downloadErrorFile?filePath={{errorFilePath}}'>این فایل </a>
      را مشاهده نمایید.</p>
  </div>
{{/if}}

<div class='import-file-container'>
  <form action='/importFiles/importCodingData' method='POST' enctype='multipart/form-data' id='frmImportCodingData' data-frmValidation novalidate>
    <h3>لطفا فایل مورد نظر را بارگذاری کنید.</h3>

    <div class='mb-3'>
      <label for='tableSelect' class='form-label' style='font-size: 18px;font-style: italic;color:#01019e;margin:15px;0;'>انتخاب جدول دیتابیس:</label>
      <select class='form-select' id='tableSelect' name='tableName' required>
        <option value=''>-- لطفا یک جدول انتخاب کنید --</option>
        {{#each tables}}
          <option value='{{this.name}}'>{{this.name}}</option>
        {{/each}}
      </select>
    </div>

    <div class='mb-3'>
      <input type='file' name='excelFile' class='form-control' id='excelFile' accept='.xlsx, .xls' required />
    </div>
    <div class='text-center'>
      <button class='btn btn-success' type='submit' style='width:120px;text-align: center;'>تایید</button>
    </div>
  </form>
</div>

<div id='progress-text' style='display: none; text-align: center; margin-top: 20px; font-size: 18px; color: #01019e;'></div>

<!-- Load CSS first -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.css" rel="stylesheet">
<!-- Load JavaScript libraries -->
<script src='https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.js'></script>
<script src='/static/assets/js/formValidation.js'></script>
<script src='/static/assets/js/importData_Progressbar.js'></script>

<script>
  // تنظیمات toastr
  toastr.options = {
    "closeButton": true,
    "progressBar": true,
    "positionClass": "toast-top-right",
    "timeOut": "3000",
    "extendedTimeOut": "1000",
    "showEasing": "swing",
    "hideEasing": "linear",
    "showMethod": "fadeIn",
    "hideMethod": "fadeOut"
  };

  // تست لود شدن اسکریپت‌ها
  console.log('Scripts loaded successfully');
  
  document.addEventListener('DOMContentLoaded', function() {
    console.log('DOM fully loaded');
    const form = document.getElementById('frmImportCodingData');
    if (form) {
      console.log('Form found');
    } else {
      console.error('Form not found!');
    }
  });
</script>